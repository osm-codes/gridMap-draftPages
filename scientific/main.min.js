function changeLevel_byDigits(e){let t=document.getElementById("fielddecode").value;t.length>0?e>0?(document.getElementById("fielddecode").value=t.replace(/[^0-9a-f]$/,"")+"7",getDecode()):e<0&&t.length>1?(document.getElementById("fielddecode").value=t.substring(0,t.length-1),getDecode()):alert("Check code or level limits"):alert("Click a point first.")}var defaultMap,openstreetmap=L.tileLayer(osmUrl,{attribution:genericAttrib,detectRetina:!0,minZoom:0,maxNativeZoom:19,maxZoom:25}),grayscale=L.tileLayer(cartoUrl,{id:"light_all",attribution:genericAttrib,detectRetina:!0,maxNativeZoom:22,maxZoom:25}),baseLayers={Grayscale:grayscale,OpenStreetMap:openstreetmap},layerPolygonCurrent=new L.geoJSON(null,{style:style,onEachFeature:onEachFeature,pointToLayer:pointToLayer}),layerCenterCurrent=new L.geoJSON(null,{style:style,onEachFeature:onEachFeature,pointToLayer:pointToLayer}),layerPolygonCurrentGrid=new L.geoJSON(null,{style:stylePolygonCurrentGrid,onEachFeature:onEachFeaturePolygonCurrentGrid,pointToLayer:pointToLayer,filter:filterLayer}),layerOlcGhsCurrent=new L.geoJSON(null,{style:styleOlcGhs,onEachFeature:onEachFeatureOlcGhs,pointToLayer:pointToLayer}),layerOlcGhsAll=new L.geoJSON(null,{style:styleOlcGhs,onEachFeature:onEachFeatureOlcGhsAll,pointToLayer:pointToLayer}),layerGridAll=new L.geoJSON(null,{style:stylePolygonCurrentGrid,onEachFeature:onEachFeaturePolygonCurrentGrid,pointToLayer:pointToLayer,filter:filterLayer}),layerPolygonAll=new L.geoJSON(null,{style:style,onEachFeature:onEachFeaturePolygonAll,pointToLayer:pointToLayer}),layerCenterAll=new L.geoJSON(null,{style:style,onEachFeature:onEachFeaturePolygonAll,pointToLayer:pointToLayer}),layerJurisdAll=new L.geoJSON(null,{style:styleJurisdAll,onEachFeature:onEachFeatureJurisd,pointToLayer:pointToLayer}),layerCoverAll=new L.geoJSON(null,{style:styleCoverAll,onEachFeature:onEachFeatureCoverAll,pointToLayer:pointToLayer}),layerMarkerCurrent=new L.featureGroup,layerMarkerAll=new L.featureGroup,overlays={"AFAcode (Active)":layerPolygonCurrent,"AFAcode (Center)":layerCenterCurrent,"AFAcode (Grid)":layerPolygonCurrentGrid,"Markers (Active)":layerMarkerCurrent,"Jurisdiction (Official)":layerJurisdAll,"OLC/GHS (Active)":layerOlcGhsCurrent,"OLC/GHS (All)":layerOlcGhsAll};function checkCountry(e,t=!0){for(var o in countries){if(new RegExp("^/?"+o+".*","i").test(e)||countries[o].isocoden===e){defaultMap=countries[o],t&&resetDef();break}}}var uri=window.location.href;let pathname=window.location.pathname;pathname=pathname.split(/[#]/)[0],pathname.match(/^\/[A-Z]{2}.+$/i)&&checkCountry(pathname,!1);var map=L.map("map",{center:defaultMap.center,zoom:defaultMap.zoom,attributionControl:!0,zoomControl:!1,renderer:L.svg(),layers:[grayscale,layerPolygonCurrent,layerCenterCurrent,layerPolygonCurrentGrid,layerCoverAll,layerJurisdAll,layerOlcGhsCurrent,layerOlcGhsAll]}),toggleTooltipStatus=!1,toggleCoverStatus=!1;map.attributionControl.setPrefix(!1),map.addControl(new L.Control.Fullscreen({position:"topleft"})),map.on("click",onMapClick);var zoom=L.control.zoom({position:"topleft"}),layers=L.control.layers(baseLayers,overlays,{position:"topleft"}),escala=L.control.scale({position:"bottomright",imperial:!1}),decodeGgeohash=L.control({position:"topleft"});decodeGgeohash.onAdd=function(e){return this.container=L.DomUtil.create("div"),this.label_field=L.DomUtil.create("label","",this.container),this.field=L.DomUtil.create("input","",this.container),this.button=L.DomUtil.create("button","leaflet-control-button",this.container),this.label_field.for="fielddecode",this.label_field.innerHTML="Grid code: ",this.field.type="text",this.field.placeholder="e.g.: "+defaultMap.scientificBase.placeholderDecode,this.field.id="fielddecode",this.button.type="button",this.button.innerHTML="Decode",L.DomEvent.disableScrollPropagation(this.button),L.DomEvent.disableClickPropagation(this.button),L.DomEvent.disableScrollPropagation(this.field),L.DomEvent.disableClickPropagation(this.field),L.DomEvent.on(this.button,"click",getDecode,this.container),L.DomEvent.on(this.field,"keyup",(function(e){13===e.keyCode&&getDecode(e)}),this.container),this.container};var encodeGgeohash=L.control({position:"topleft"});encodeGgeohash.onAdd=function(e){return this.container=L.DomUtil.create("div","leaflet-control-encode"),this.label_field=L.DomUtil.create("label","",this.container),this.label_tcode=L.DomUtil.create("label","",this.container),this.select_tcode=L.DomUtil.create("select","",this.container),this.field=L.DomUtil.create("input","",this.container),this.button=L.DomUtil.create("button","leaflet-control-button",this.container),this.label_tcode.for="tcode",this.label_tcode.innerHTML="",this.select_tcode.id="tcode",this.select_tcode.name="tcode",this.select_tcode.innerHTML='<option value="none">(Free)</option><option value="">AFAcode</option><option value="olc">OLC</option><option value="ghs">GHS</option><option value="ghs64">GHS64</option>',this.label_field.for="fieldencode",this.label_field.innerHTML="Equivalent Geo URI:<br/>",this.field.type="text",this.field.placeholder="e.g.: "+defaultMap.scientificBase.placeholderEncode,this.field.id="fieldencode",this.button.type="button",this.button.innerHTML="Encode",L.DomEvent.disableScrollPropagation(this.container),L.DomEvent.disableClickPropagation(this.container),L.DomEvent.on(this.button,"click",getEncode,this.container),L.DomEvent.on(this.field,"keyup",(function(e){13===e.keyCode&&getEncode(e)}),this.container),L.DomEvent.on(this.select_tcode,"change",changePlaceholder,this.container),this.container};var level=L.control({position:"topleft"});level.onAdd=function(e){return this.container=L.DomUtil.create("div"),this.label_level=L.DomUtil.create("label","",this.container),this.select_level=L.DomUtil.create("select","",this.container),this.label_grid=L.DomUtil.create("label","",this.container),this.select_grid=L.DomUtil.create("select","",this.container),this.label_grid.for="grid",this.label_grid.innerHTML=" ",this.select_grid.id="grid",this.select_grid.name="grid",this.select_grid.innerHTML=generateSelectGrid(defaultMap.scientificBase.selectGrid),this.label_level.for="level",this.label_level.innerHTML='<a href="https://wiki.addressforall.org/doc/osmc:Viz/Navega%C3%A7%C3%A3o" target="_help">Level</a>: ',this.select_level.id="level_size",this.select_level.name="level",this.select_level.innerHTML=generateSelectLevel(defaultMap.scientificBase),L.DomEvent.disableScrollPropagation(this.container),L.DomEvent.disableClickPropagation(this.container),this.container};var levelFilter=L.control({position:"topleft"});levelFilter.onAdd=function(e){return this.container=L.DomUtil.create("div"),this.label_filter=L.DomUtil.create("label","",this.container),this.select_filter=L.DomUtil.create("select","",this.container),this.label_filter.for="filter",this.label_filter.innerHTML="Level filter: ",this.select_filter.id="filter_size",this.select_filter.name="filter",this.select_filter.innerHTML='<option value="0">All</option><option value="1">Half</option><option value="2">Int</option><option value="4">Hexadecimal</option><option value="5">base32</option>',L.DomEvent.disableScrollPropagation(this.container),L.DomEvent.disableClickPropagation(this.container),L.DomEvent.on(this.select_filter,"change",updateSelectLevel,this.container),this.container};var clear=L.control({position:"topleft"});clear.onAdd=function(e){return this.container=L.DomUtil.create("div"),this.button=L.DomUtil.create("button","leaflet-control-button",this.container),this.button.type="button",this.button.innerHTML="Clear all",L.DomEvent.disableScrollPropagation(this.button),L.DomEvent.disableClickPropagation(this.button),L.DomEvent.on(this.button,"click",resetDef,this.container),this.container};var toggleTooltip=L.control({position:"topleft"});toggleTooltip.onAdd=function(e){return this.container=L.DomUtil.create("div"),this.button=L.DomUtil.create("button","leaflet-control-button",this.container),this.button.type="button",this.button.innerHTML="Tooltip",L.DomEvent.disableScrollPropagation(this.button),L.DomEvent.disableClickPropagation(this.button),L.DomEvent.on(this.button,"click",toggleTooltipLayers,this.container),this.container};var geoUriDiv=L.control({position:"topright"});geoUriDiv.onAdd=function(e){return this.container=L.DomUtil.create("div"),this.container.innerHTML='<a id="hasGeoUri" href="#fieldencode" title="Latitude,Longitude: click here to get it as Geo URI standard"><span id="geoUri" class="font_small"></span></a>',L.DomEvent.disableScrollPropagation(this.container),L.DomEvent.disableClickPropagation(this.container),this.container},zoom.addTo(map),layers.addTo(map),geoUriDiv.addTo(map),escala.addTo(map),decodeGgeohash.addTo(map),encodeGgeohash.addTo(map),level.addTo(map),levelFilter.addTo(map),clear.addTo(map),toggleTooltip.addTo(map);var a=document.getElementById("custom-map-controlsa"),b=document.getElementById("custom-map-controlsb");function resetDef(){layerPolygonCurrent.clearLayers(),layerCenterCurrent.clearLayers(),layerPolygonCurrentGrid.clearLayers(),layerGridAll.clearLayers(),layerCenterAll.clearLayers(),layerPolygonAll.clearLayers(),layerMarkerCurrent.clearLayers(),layerMarkerAll.clearLayers(),layerOlcGhsCurrent.clearLayers(),layerOlcGhsAll.clearLayers(),map.removeLayer(layerCoverAll),toggleCoverStatus=!0,document.getElementById("level_size").innerHTML=generateSelectLevel(defaultMap.scientificBase),document.getElementById("grid").innerHTML=generateSelectGrid(defaultMap.scientificBase.selectGrid),document.getElementById("fielddecode").placeholder="geocode, e.g.: "+defaultMap.scientificBase.placeholderDecode,document.getElementById("fieldencode").placeholder="geo: "+defaultMap.scientificBase.placeholderEncode}function zoomToJurisd(){map.setView(defaultMap.center,defaultMap.zoom)}function toggleTooltipLayers(){map.eachLayer((function(e){if(map.hasLayer(e)&&e.getTooltip()){var t=e.getTooltip();e.unbindTooltip(),t.options.permanent=!toggleTooltipStatus,e.bindTooltip(t)}})),toggleTooltipStatus=!toggleTooltipStatus}function generateSelectGrid(e){let t="",o="";for(let l=0;l<e.length;l++)t+='<option value="grid'+e[l]+'">'+e[l]+" grid</option>",o+='<option value="grid'+(e[l]+1)+'">'+e[l]+" points</option>";return'<option value="">Cell</option>'+t+o}function generateSelectLevel(e,t=0,o=0){let l="",r=0,a=1,i=0;1==o?(a=2,i=1):2==o?(a=2,i=0):4==o?(a=4,i=0):5==o&&(a=5,i=0);const n=e.endLevel;for(let e=0;e<=n;e++){if(e%a!==i)continue;r=e%4==0?e/4+1:Math.floor(e/4)+2;const o=Math.pow(2,n-e),c=Math.sqrt(o),s=Math.round(111*c)/100;l+=`<option value="${s}"${t<=s?" selected":""}>L${e} (${r}d) (${c<1e3?Math.round(100*c)/100+"m":Math.round(100*c/1e3)/100+"km"}) ${e%2==0?"&#9643;":"&#9645;"}</option>`}return l}function updateSelectLevel(){let e=document.getElementById("level_size").value,t=document.getElementById("filter_size").value;document.getElementById("level_size").innerHTML=generateSelectLevel(defaultMap.scientificBase,e,t)}function getDecode(e){let t=document.getElementById("fielddecode").value;if(t.match(/^geo:(olc|ghs):.+$/i))loadGeojson(o=uri_base_api+"/"+t,[layerOlcGhsCurrent,layerOlcGhsAll],afterLoadLayer,(function(e){}));else if(null!==t&&""!==t){var o=uri_base_api+"/geo:afa:";new RegExp("^"+defaultMap.isocode+"[+].*","i").test(t)||(o+=defaultMap.isocode+defaultMap.scientificBase.symbol),o+=t,document.getElementById("fieldencode").value="",loadGeojson(o,[layerPolygonCurrent,layerPolygonAll],afterLoadLayer,afterData)}}function changePlaceholder(){let e=document.getElementById("tcode").value,t=document.getElementById("fieldencode").value;!e.match(/^(olc|ghs|ghs64)$/i)||null!==t&&""!==t?document.getElementById("fieldencode").placeholder="e.g.: "+defaultMap.bases[defaultMap.postalcodeBase].placeholderEncode:document.getElementById("fieldencode").placeholder="e.g.: geo:"+(""===e?"":e+":")+defaultMap.bases[defaultMap.postalcodeBase].placeholderEncode}function getEncode(e){let t=document.getElementById("fieldencode").value,o=document.getElementById("level_size").value,l=document.getElementById("tcode").value,r=document.getElementById("grid").value,a=defaultMap.isocode,i=uri_base_api+"/";if(null!==t&&""!==t&&t.match(/^((geo:((olc|ghs|ghs64|lex):)?)?|(urn:lex:))?(\-?\d+\.?\d*,\-?\d+\.?\d*)(;u=\d+\.?\d*)?$/i)){let e="geo:"+(""===l||"none"===l?"":l+":"),n=/^(.*:)?(\-?\d+\.?\d*,\-?\d+\.?\d*)(;u=\d+\.?\d*)?$/i,c=/^(.*)(;u=)(\d+\.?\d*)$/i;if(t.match(n)){let l;t.match(/^geo:(olc|ghs|ghs64):.+$/i)||(t=t.replace(n,e+"$2$3")),t.match(c)?(l=Number(t.split(";u=")[1]),0==l&&(l=levelValues[defaultMap.scientificBase.endLevel]),l=l>9?Math.round(l):Math.round(10*l)/10):l=o,t=t.replace(n,"$1$2;u="+l),i+=t;let s=t.replace(/^geo:(.*:)?(.*)$/i,"$2"),d="latlng: "+s;layerMarkerCurrent.clearLayers(),L.marker(s.split(/[;,]/,2)).addTo(layerMarkerCurrent).bindPopup(d),L.marker(s.split(/[;,]/,2)).addTo(layerMarkerAll).bindPopup(d),t.match(/^geo:(olc|ghs|ghs64):.+$/i)?loadGeojson(i,[layerOlcGhsCurrent,layerOlcGhsAll],afterLoadLayer,(function(e){})):(document.getElementById("fielddecode").value="",i+="/"+defaultMap.scientificBase.name,layerPolygonCurrent.clearLayers(),""!==r?(i+="/"+a,layerPolygonCurrent.clearLayers(),layerCenterCurrent.clearLayers(),layerPolygonCurrentGrid.clearLayers(),loadGeojson(uriGrid,[layerPolygonCurrentGrid,layerGridAll],afterLoadLayer,afterData)):(i+="/"+r+"/"+a,layerPolygonCurrentGrid.clearLayers(),loadGeojson(i,[layerPolygonCurrent,layerPolygonAll],afterLoadLayer,afterData)))}}}function sortAndRemoveDuplicates(e){return[...new Set(e.trim().split(/[\n,]+/).map((e=>e.trim().substring(0,11))))].sort().join(",")}function fixZOrder(e){Object.keys(e).forEach((function(t){var o=e[t];o._layers&&Object.keys(o._layers).length>0&&o._layers[Object.keys(o._layers)[0]]._path&&o._layers[Object.keys(o._layers)[0]]._path.parentNode&&o.bringToFront()}))}function latRound(e){return Number.parseFloat(e).toFixed(6)}function onMapClick(e){let t=document.getElementById("level_size").value,o=document.getElementById("grid").value;var l=uri_base_api+"/geo:"+e.latlng.lat+","+e.latlng.lng+";u="+t+"/"+defaultMap.scientificBase.name+"/"+defaultMap.isocode,r=uri_base_api+"/geo:"+e.latlng.lat+","+e.latlng.lng+";u="+t+"/"+defaultMap.scientificBase.name+(o?"/"+o:"")+"/"+defaultMap.isocode,a="latlng: "+e.latlng.lat+","+e.latlng.lng;document.getElementById("fieldencode").value="geo:"+latRound(e.latlng.lat)+","+latRound(e.latlng.lng)+";u="+t,document.getElementById("geoUri").innerHTML="geo:"+latRound(e.latlng.lat)+","+latRound(e.latlng.lng)+";u="+t,layerMarkerCurrent.clearLayers(),L.marker(e.latlng).addTo(layerMarkerCurrent).bindPopup(a),L.marker(e.latlng).addTo(layerMarkerAll).bindPopup(a),""!==o?(layerPolygonCurrent.clearLayers(),layerCenterCurrent.clearLayers(),layerPolygonCurrentGrid.clearLayers(),loadGeojson(r,[layerPolygonCurrentGrid,layerGridAll],afterLoadLayer,afterData)):(layerPolygonCurrentGrid.clearLayers(),loadGeojson(l,[layerPolygonCurrent,layerPolygonAll],afterLoadLayer,afterData))}function style(e){return{color:"black",fillColor:"deeppink",fillOpacity:.1,weight:0}}function popUpFeature(e,t){sufix_area=e.properties.area<1e6?"m²":"km²",value_area=e.properties.area<1e6?Math.round(100*e.properties.area)/100:Math.round(100*e.properties.area/1e6)/100,sufix_side=e.properties.side<1e3?"m":"km",value_side=e.properties.side<1e3?Math.round(100*e.properties.side)/100:Math.round(100*e.properties.side/1e3)/100;var o="";e.properties.type?o+=e.properties.type.toUpperCase()+" code: <big><code>"+e.id+"</code></big><br>":e.properties.index?o+="Id: <big><code>"+e.properties.index+"</code></big><br>":o+="Id: <big><code>"+e.id+"</code></big><br>",o+="Area: "+value_area+" "+sufix_area+"<br>",o+="Side: "+value_side+" "+sufix_side+"<br>",e.properties.prefix&&(o+="Prefix: "+e.properties.prefix+"<br>"),e.properties.code_subcell&&(o+="Code_subcell: "+e.properties.code_subcell+"<br>"),t.bindPopup(o)}function layerTooltipFeature(e,t){if(e.properties.code_subcell)var o=e.properties.code_subcell;else if(e.properties.index)o="."+e.properties.index;else o=e.id;t.bindTooltip(o,{permanent:toggleTooltipStatus,direction:"auto",className:"tooltipbase16h1c"})}function layerTooltipFeature2(e,t){t.bindTooltip(e.id,{permanent:toggleTooltipStatus,direction:"auto",className:"tooltipbase16h1ca"})}function layerTooltipFeature3(e,t){t.bindTooltip(e.properties.code_subcell,{permanent:toggleTooltipStatus,direction:"auto",className:"tooltipbase16h1ca"})}function highlightFeature(e){this.openTooltip()}function resetHighlight(e,t){layerPolygonCurrent.resetStyle(e.target),layerPolygonAll.resetStyle(e.target)}function onFeatureClick(e){map.fitBounds(e.target.getBounds())}function onEachFeature(e,t){popUpFeature(e,t),layerTooltipFeature(e,t),layerCenterCurrent.clearLayers(),L.circleMarker(t.getBounds().getCenter(),{color:"black",radius:3,weight:1,opacity:.8,fillOpacity:.6}).addTo(layerCenterCurrent),e.id&&(document.getElementById("sciCode").innerHTML=e.id.split("+",2).replace(/(...)(?!$)/g,"$1.").replace(/([GQHMRVJKNPSTZY])/g,".$1").replace(/(\.\.)/g,".")),t.on({click:onFeatureClick,mouseover:highlightFeature,mouseout:resetHighlight})}function pointToLayer(e,t){return L.circleMarker(t,{radius:3,weight:1,opacity:.8,fillOpacity:.6})}function highlightFeatureOlcGhs(e){const t=e.target;document.getElementById("notooltip").checked?(this.closeTooltip(),t.setStyle({color:"yellow",weight:1}),t.bringToFront()):this.openTooltip()}function resetHighlightOlcGhs(e,t){layerOlcGhsCurrent.resetStyle(e.target),layerOlcGhsAll.resetStyle(e.target)}function styleOlcGhs(e){return{color:"black",fillColor:"yellow",fillOpacity:.1,weight:0}}function onEachFeatureOlcGhs(e,t){popUpFeature(e,t),layerTooltipFeature(e,t),L.circleMarker(t.getBounds().getCenter(),{color:"black",radius:3,weight:1,opacity:.8,fillOpacity:.6}).addTo(layerOlcGhsCurrent),t.on({click:onFeatureClick,mouseover:highlightFeature,mouseout:resetHighlight})}function onEachFeatureOlcGhsAll(e,t){popUpFeature(e,t),layerTooltipFeature(e,t),L.circleMarker(t.getBounds().getCenter(),{color:"black",radius:3,weight:1,opacity:.8,fillOpacity:.6}).addTo(layerOlcGhsAll),t.on({click:onFeatureClick,mouseover:highlightFeatureOlcGhs,mouseout:resetHighlightOlcGhs})}function onEachFeaturePolygonAll(e,t){popUpFeature(e,t),layerTooltipFeature(e,t),L.circleMarker(t.getBounds().getCenter(),{color:"black",radius:3,weight:1,opacity:.8,fillOpacity:.6}).addTo(layerCenterAll),t.on({click:onFeatureClick,mouseover:highlightFeature,mouseout:resetHighlight})}function styleJurisdAll(e){return{color:"red",fillColor:"none",fillOpacity:.1}}function onEachFeatureJurisd(e,t){var o="";o+="osm_id: "+e.properties.osm_id+"<br>",o+="jurisd_base_id: "+e.properties.jurisd_base_id+"<br>",o+="jurisd_local_id: "+e.properties.jurisd_local_id+"<br>",o+="parent_id: "+e.properties.parent_id+"<br>",o+="admin_level: "+e.properties.admin_level+"<br>",o+="name: "+e.properties.name+"<br>",o+="parent_abbrev: "+e.properties.parent_abbrev+"<br>",o+="abbrev: "+e.properties.abbrev+"<br>",o+="wikidata_id: "+e.properties.wikidata_id+"<br>",o+="lexlabel: "+e.properties.lexlabel+"<br>",o+="isolabel_ext: "+e.properties.isolabel_ext+"<br>",o+="lex_urn: "+e.properties.lex_urn+"<br>",o+="name_en: "+e.properties.name_en+"<br>",o+="isolevel: "+e.properties.isolevel+"<br>",o+="area: "+e.properties.area+"<br>",o+="jurisd_base_id: "+e.properties.jurisd_base_id+"<br>",document.getElementById("nameJurisd").innerHTML=" of "+e.properties.name,t.bindPopup(o)}function resetHighlightCoverAll(e,t){layerCoverAll.resetStyle(e.target)}function onEachFeatureCoverAll(e,t){popUpFeature(e,t),layerTooltipFeature(e,t),t.on({click:onFeatureClick,mouseover:highlightFeature,mouseout:resetHighlightCoverAll})}function styleCoverAll(e){return{color:"black",fillColor:"deeppink",fillOpacity:.1,weight:1}}function highlightFeaturePolygonCurrentGrid(e){this.openTooltip()}function filterLayer(e,t){return e.properties.code_subcell}function resetHighlightPolygonCurrentGrid(e,t){layerPolygonCurrentGrid.resetStyle(e.target),layerGridAll.resetStyle(e.target)}function stylePolygonCurrentGrid(e){return"Point"===e.geometry.type?{color:"deeppink",weight:1}:{color:"deeppink",fillColor:"deeppink",fillOpacity:.1,weight:1}}function onEachFeaturePolygonCurrentGrid(e,t){popUpFeature(e,t),layerTooltipFeature3(e,t),t.on({click:onFeatureClick,mouseover:highlightFeaturePolygonCurrentGrid,mouseout:resetHighlightPolygonCurrentGrid})}function onEachFeaturePolygonAllGrid(e,t){popUpFeature(e,t),layerTooltipFeature2(e,t),t.on({click:onFeatureClick})}function afterLoadLayer(e){let t=map.getBoundsZoom(e.getBounds());map.setView(e.getBounds().getCenter(),t-(t<10?1:t<20?2:t<24?3:4))}function afterLoadJurisdAll(e,t=!0,o=!0){t?(map.fitBounds(e.getBounds(),{reset:!0}),map.options.minZoom=map.getZoom()):map.options.minZoom=map.getBoundsZoom(e.getBounds()),o&&map.setMaxBounds(e.getBounds())}function afterLoadLayerCoverAll(e,t=!0,o=!0){toggleCoverStatus?afterLoadJurisdAll(e,t,o):(map.removeLayer(e),toggleCoverStatus=!0)}function afterData(e,t){if(("Feature"===e.type||"FeatureCollection"===e.type&&1==e.features.length)&&("FeatureCollection"===e.type&&(e=e.features[0]),e.properties.jurisd_base_id&&checkCountry(e.properties.jurisd_base_id,!1),!e.properties.index)){if(e.id){var o=uri_base+"/"+e.id;const t="AFA.codes: "+e.id,l={additionalInformation:"to canonical."};window.history.pushState(l,t,o),document.getElementById("fielddecode").value=e.id,e.properties.truncated_code&&alert("Geocódigo truncado. Número de dígitos excedeu o limite de níveis da grade.")}if(e.properties.side){document.getElementById("level_size").innerHTML=generateSelectLevel(defaultMap.scientificBase,e.properties.side,document.getElementById("filter_size").value);const o=t.getBounds().getCenter(),{lat:l,lng:r}=o,a="geo:"+latRound(l)+","+latRound(r)+";u="+document.getElementById("level_size").value;document.getElementById("geoUri").innerHTML=a,document.getElementById("fieldencode").value=a}}}function afterDataOlcGhs(e,t){if((e.features.length=1)&&e.features[0].properties.side){document.getElementById("level_size").innerHTML=generateSelectLevel(defaultMap.scientificBase,e.features[0].properties.side,document.getElementById("filter_size").value);const o=t.getBounds().getCenter(),{lat:l,lng:r}=o,a="geo:"+latRound(l)+","+latRound(r)+";u="+document.getElementById("level_size").value;document.getElementById("geoUri").innerHTML=a,document.getElementById("fieldencode").value=a}}function loadGeojson(e,t,o,l){fetch(e).then((e=>e.json())).then((e=>{for(t[0].clearLayers(),i=0;i<t.length;i++)"FeatureCollection"===e.type?t[i].addData(e.features):t[i].addData(e);o(t[0]),l(e,t[0]),fixZOrder(overlays)})).catch((e=>{}))}a.appendChild(decodeGgeohash.getContainer()),a.appendChild(encodeGgeohash.getContainer()),a.appendChild(level.getContainer()),a.appendChild(levelFilter.getContainer()),b.appendChild(clear.getContainer()),b.appendChild(toggleTooltip.getContainer());var uriApi="",uriApiJurisd="";const reg_esp_caracter=/\./g;pathnameNoDot=pathname.replace(reg_esp_caracter,""),pathname.match(/\/base16\/grid/)?uriApi=uri.replace(/(\/base16\/grid)/,"$1"):pathname.match(/(\/base16h)?\/grid/)?uriApi=uri.replace(/((\/base16h)?\/grid)/,"$1"):pathnameNoDot.match(/\/[A-Z]{2}\+.*$/i)?(uriApi=uri_base_api+pathnameNoDot.replace(/\/([A-Z]{2}\+.*)$/i,"/geo:afa:$1"),uriApiJurisd=uri_base_api+pathnameNoDot.replace(/\/(([A-Z]{2})\+.*)$/i,"/geo:iso_ext:$2")):pathname.match(/\/[A-Z]{2}\/geo:(olc|ghs):.+$/i)?(loadGeojson(uri.replace(/\/[A-Z]{2}\/(geo:(olc|ghs).*)$/i,"/$1"),[layerOlcGhsCurrent,layerOlcGhsAll],afterLoadLayer,afterDataOlcGhs),loadGeojson(uri.replace(/\/([A-Z]{2})\/(geo:(olc|ghs).*)$/i,"/geo:iso_ext:$1"),[layerJurisdAll],(function(e){afterLoadJurisdAll(e,!1,!1)}),afterData)):pathname.match(/^\/geo:.+$/i)&&(uriApi=uri,getJurisdAfterLoad=!0),null!==uriApi&&""!==uriApi&&loadGeojson(uriApi,[layerPolygonCurrent,layerPolygonAll],afterLoadLayer,afterData),null!==uriApiJurisd&&""!==uriApiJurisd&&(loadGeojson(uriApiJurisd,[layerJurisdAll],(function(e){afterLoadJurisdAll(e,!1,!1)}),afterData),loadGeojson(uriApiJurisd+"/cover",[layerCoverAll],(function(e){afterLoadLayerCoverAll(e,!1,!1)}),(function(e){})));